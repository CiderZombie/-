import os
import pandas as pd
import xlrd

folder_path = r'C:\Users\ldh1020\OneDrive - KccGlass\바탕 화면\kccfc\1.업무\★회계★\1. 마감및 결산\3. 고정자산\PC 확인\8. PC QR 관리\.venv\엑셀파일 모음'
merged_data = []

for file_name in os.listdir(folder_path):
    if file_name.endswith('.xls'):
        file_path = os.path.join(folder_path, file_name)
        workbook = xlrd.open_workbook(file_path)
        sheet = workbook.sheet_by_index(0)

        # 각 행에서 데이터를 읽어 merged_data DataFrame에 추가합니다.
        for row in range(1, sheet.nrows):
            row_data = sheet.row_values(row)
            merged_data.append(row_data)

output_path = r'C:\Users\ldh1020\OneDrive - KccGlass\바탕 화면\kccfc\1.업무\★회계★\1. 마감및 결산\3. 고정자산\PC 확인\8. PC QR 관리\.venv\엑셀파일 모음\엑셀병합본\엑셀병합.xlsx'
merged_df = pd.DataFrame(merged_data)
merged_df.to_excel(output_path, index=False)
